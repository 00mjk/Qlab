% Copyright 2010 Raytheon BBN Technologies
%
% Licensed under the Apache License, Version 2.0 (the "License");
% you may not use this file except in compliance with the License.
% You may obtain a copy of the License at
%
%     http://www.apache.org/licenses/LICENSE-2.0
%
% Unless required by applicable law or agreed to in writing, software
% distributed under the License is distributed on an "AS IS" BASIS,
% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
% See the License for the specific language governing permissions and
% limitations under the License.
%
% File: file_counter.m
%
% Description: Creates a GUI display of a file number counter
% button

function file_counter(parent, position, counter, path_fcn)
    % FUNCTION file_counter
    % INPUTS:
    % parent - handle of parent window/figure
    % position - position vector of the form [left bottom]
    % counter - the initial value of the counter
    % path_fcn - finds the current value of the data path
    
    height = 25;
    
    % display edit box and reset button in a row with label above
    labelWidth = 60;
    editboxWidth = 50;
    buttonWidth = 50;
    gutter = 10;
    labelPosition = [position(1) position(2)+height-5 labelWidth height];
    editboxPosition = [position(1) position(2) editboxWidth height];
    buttonPosition = [editboxPosition(1)+editboxWidth+gutter position(2) buttonWidth height];

    % create label
    uicontrol( ...
            'Parent', parent, ...
            'Style', 'text', ...
            'Units', 'pixels', ...
            'Position', labelPosition, ...
            'FontName', 'Helvetica', ...
            'FontSize', 10, ...
            'String', 'File #');
        
    % create edit box
    editbox = uicontrol( ...
            'Parent', parent, ...
            'Style', 'edit', ...
			'BackgroundColor', 'white', ...
            'Units', 'pixels', ...
            'Position', editboxPosition, ...
            'FontName', 'Helvetica', ...
            'FontSize', 10, ...
            'Enable', 'inactive', ...
            'String', sprintf('%03d', counter.value));
        
    % create reset button
    uicontrol( ...
            'Parent', parent, ...
            'Style', 'pushbutton', ...
            'Units', 'pixels', ...
            'Position', buttonPosition, ...
            'FontName', 'Helvetica', ...
            'FontSize', 10, ...
            'String', 'Reset', ...
            'Callback', {@reset_callback});

    % add editbox to counter object handle list
    counter.add_uihandle(editbox);

    function reset_callback(hObject, eventData)
        counter.reset( path_fcn() );
    end
end